- step:
    name: load_data
    image: docker.io/python:3.10
    environment: pro-trial-prod-oci-vm-gpu-a10-1
    command:
      - pip install -r requirements.txt
      - python load_data.py {parameters}
    inputs:
      - name: images
        default: https://s3.eu-central-1.amazonaws.com/avg-kitti/data_object_image_2.zip
        description: Input dataset as a tar/zip package
      - name: labels
        default: https://s3.eu-central-1.amazonaws.com/avg-kitti/data_object_label_2.zip
        description: Input dataset labels as a tar/zip package
      - name: specs
        default: datum://0197a7ea-49a6-5ce6-81a8-907f8325268a
        description: Sample configuration file shown below converts the 100% KITTI dataset to the training set.
    parameters:
      - name: num_plot_images
        type: integer
        default: 10
        description: Number of images to plot
- step:
    name: train
    image: nvcr.io/nvidia/tao/tao-toolkit:5.0.0-tf1.15.5
    environment: pro-trial-prod-oci-vm-gpu-a10-1
    inputs:
      - name: dataset
        default: dataset://KITTI/version2
        description: Path to the dataset created in the previous step
        keep-directories: full
      - name: train_specs
        default: datum://0197cd67-a25d-9804-536a-2d420f98ee3a
      - name: pretrained_model
        default: datum://0197f671-cb76-c9d9-8033-46ca3d8a1335
    parameters:
      - name: num_plot_images
        type: integer
        default: 10
        description: Number of images to plot
    command:
      - pip install -r requirements.txt
      - python train.py
    environment-variables:
      - name: NGC_API_KEY
        default: ${NGC_API_KEY}
        description: NGC API key
- step:
    name: evaluate
    image: nvcr.io/nvidia/tao/tao-toolkit:5.0.0-tf1.15.5
    environment: pro-trial-prod-oci-vm-gpu-a10-1
    inputs:
      - name: dataset
        default: dataset://KITTI/version2
        description: Path to the dataset created in the previous step
        keep-directories: full
      - name: train_specs
        default: datum://0197f478-4dc8-d6d9-585f-9c401fc0f8e1
      - name: tfrecords
        default: datum://0197f652-e8be-e1fc-177b-c1130b8fdbc0
      - name: model
        default: datum://0197f478-4d1a-944a-5bb6-b6fa509fc2a2
    command:
      - pip install -r requirements.txt
      - python evaluate.py
    environment-variables:
      - name: NGC_API_KEY
        default: ${NGC_API_KEY}
        description: NGC API key
